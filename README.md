# WindowInspector - 窗口文本自动填充工具

Windows平台的自动化文本填充工具，支持普通窗口和Excel两种模式。

## 功能特性

- 🎯 **窗口定位** - 点击选择任意Windows窗口
- 📍 **位置记录** - 记录输入框坐标或Excel单元格地址
- 💾 **文本管理** - 保存多组文本，支持重命名和删除
- 📊 **Excel集成** - 批量导入/导出Excel数据
- ⚡ **一键填充** - 自动填充文本到目标位置
- 🔧 **配置管理** - 多配置保存和快速切换
- 🔴 **Caps Lock监控** - 实时显示大写锁定状态

## 快速开始

### 编译运行

```bash
# 编译
dotnet build -c Release

# 运行
dotnet run

# 发布（生成独立可执行文件）
publish.bat
```

或使用批处理文件：
- `build.bat` - 编译
- `run.bat` - 运行
- `publish.bat` - 发布程序

---

## 详细使用教程

### 场景1：普通窗口文本填充（如记事本、浏览器表单）

#### 第一步：配置窗口和位置

1. **启动程序**
   - 双击运行 `WindowInspector.exe`

2. **选择目标窗口**
   - 点击"1. 选择目标窗口"按钮
   - 在10秒内点击你要操作的窗口（如记事本）
   - 程序会显示"已选择窗口: 无标题 - 记事本"

3. **记录输入框位置**
   - 在"数量"框中输入输入框数量（如2个）
   - 点击"2. 记录输入框位置"
   - 依次点击每个输入框的位置
   - 按ESC键可以取消操作
   - 完成后会提示保存配置

4. **保存配置**
   - 在弹出的对话框中输入配置名称（如"记事本配置"）
   - 点击"是"保存配置
   - 配置会保存到 `configs/` 目录

#### 第二步：保存文本内容

1. **手动保存文本**
   - 点击"保存输入内容"按钮
   - 输入名称（如"客户信息1"）
   - 依次输入每个输入框的文本内容
   - 点击确定

2. **重复保存多组文本**
   - 可以保存多组不同的文本内容
   - 每组文本都会显示在下拉框中

#### 第三步：填充文本

1. **选择要填充的文本**
   - 从下拉框选择文本（如"客户信息1"）
   - 状态栏会显示文本内容和填充状态

2. **点击填充**
   - 点击"填充"按钮
   - 程序会自动：
     - 激活目标窗口
     - 移动鼠标到各个位置
     - 点击并输入文本
   - 填充完成后自动切换到下一组文本

3. **批量连续填充**
   - 如果有多组文本，填充完一组后会自动切换到下一组
   - 继续点击"填充"即可填充下一组
   - 状态栏显示进度：`📊 进度: 5/100 已完成`

---

### 场景2：Excel批量数据录入

#### 第一步：配置Excel单元格

1. **打开Excel文件**
   - 先打开你要操作的Excel文件

2. **选择Excel窗口**
   - 点击"1. 选择目标窗口"
   - 点击Excel窗口
   - 程序会自动检测并显示"📊 检测到Excel窗口"

3. **配置单元格地址**
   - 点击"2. 记录输入框位置"
   - 弹出单元格配置对话框

4. **单个模式配置**
   - 在每个输入框中输入单元格地址（如A1, B1, C1）
   - 或点击"选择"按钮，切换到Excel选中单元格，地址会自动填入

5. **批量模式配置**（推荐）
   - 点击"切换到批量模式"
   - 点击"在Excel中选择"按钮
   - 在Excel中拖选多个单元格（如A1:C10）
   - 返回对话框，所有单元格地址已自动填入
   - 点击确定

6. **保存配置**
   - 输入配置名称（如"客户信息表"）
   - 点击"是"保存

#### 第二步：批量导入数据

1. **从Excel文件加载数据**
   - 点击"加载"按钮
   - 选择包含数据的Excel文件
   - 程序会自动读取所有行数据

2. **数据格式**
   - 如果Excel第一行是"名称"，会识别为标准格式
   - 否则会自动生成名称（Excel行1, Excel行2...）

3. **查看导入结果**
   - 所有数据会添加到下拉框
   - 带📊标记的是从Excel导入的数据

4. **永久保存Excel数据**（新功能）
   - 右键点击"保存输入内容"按钮
   - 确认后将当前Excel数据永久保存到配置
   - 保存后数据不再显示📊标记，成为本地配置的一部分
   - 即使不再加载Excel文件，这些数据也会保留

#### 第三步：批量填充

1. **选择第一条数据**
   - 从下拉框选择要填充的数据

2. **连续填充**
   - 点击"填充"按钮 → 填充第1条
   - 自动切换到第2条
   - 继续点击"填充" → 填充第2条
   - 重复直到完成所有数据

3. **查看进度**
   - 状态栏实时显示：
     ```
     📊 进度: 25/100 已完成
     
     最近已填充:
       ✅ 客户25 (刚刚)
       ✅ 客户24 (1分钟前)
       ✅ 客户23 (2分钟前)
     
     ▶️ 下一个待填充: 客户26
     ```

4. **重置填充状态**
   - 如果需要重新填充，左键点击"配置操作"
   - 选择"重置所有填充状态"
   - 所有数据恢复为待填充状态

---

### 场景3：配置管理

#### 保存配置

1. **自动保存**
   - 记录完位置后会自动提示保存
   - 输入配置名称即可

2. **手动另存为**
   - 左键点击"配置操作"
   - 选择"另存为配置..."
   - 输入新的配置名称

#### 加载配置

1. **快速加载**
   - 右键点击"配置操作"
   - 从列表中选择已保存的配置

2. **浏览加载**
   - 右键点击"配置操作"
   - 选择"加载配置..."
   - 浏览并选择配置文件

3. **自动加载**
   - 程序启动时会自动加载上次使用的配置

#### 配置文件位置

- `configs/` - 所有命名配置
- `window_config.json` - 默认配置
- `window_position.json` - 窗口位置
- `last_config.json` - 上次使用的配置

---

### 场景4：数据导入导出

#### 导出数据到Excel

1. **点击导出按钮**
   - 点击"导出"按钮
   - 选择保存位置和文件名

2. **导出格式**
   ```
   | 名称    | 文本1  | 文本2  | 文本3  |
   |---------|--------|--------|--------|
   | 客户1   | 张三   | 13800  | 北京   |
   | 客户2   | 李四   | 13900  | 上海   |
   ```

#### 从Excel导入数据

1. **点击加载按钮**
   - 点击"加载"按钮
   - 选择Excel文件

2. **自动识别格式**
   - 如果有"名称"列，读取名称和文本
   - 如果没有，自动生成名称

3. **批量导入**
   - 支持导入任意行数的数据
   - 所有数据添加到文本列表

---

### 高级功能

#### 文本管理

1. **重命名文本**
   - 右键点击文本下拉框
   - 选择"重命名"
   - 输入新名称

2. **删除文本**
   - 右键点击文本下拉框
   - 选择"删除"
   - 确认删除

#### Caps Lock监控

- 右下角圆形指示器
- 绿色 = Caps Lock关闭
- 红色 = Caps Lock开启
- 实时监控，避免输入错误

#### 快捷键

- **ESC** - 取消位置记录
- **右键文本下拉框** - 文本管理菜单
- **左键配置按钮** - 保存/清除配置
- **右键配置按钮** - 加载配置

---

## 使用技巧

### 提高效率

1. **使用批量模式**
   - Excel模式下使用批量选择
   - 一次性配置多个单元格

2. **配置多个方案**
   - 为不同窗口保存不同配置
   - 快速切换使用

3. **批量导入数据**
   - 从Excel导入大量数据
   - 连续填充提高效率

### 避免错误

1. **窗口位置固定**
   - 记录位置后不要改变窗口大小
   - 否则需要重新记录

2. **检查Caps Lock**
   - 注意右下角指示器
   - 避免大小写错误

3. **定期保存配置**
   - 使用"另存为配置"保存重要配置
   - 避免数据丢失

## Excel模式

程序会自动检测Excel窗口并切换到Excel模式：

1. 选择Excel窗口
2. 输入单元格地址（如A1, B2）
3. 使用"加载"按钮从Excel文件批量导入数据
4. 使用"导出"按钮将数据导出到Excel

### Excel文件格式

导出格式：
```
| 名称 | 文本1 | 文本2 | ...
```

导入时自动识别此格式，也支持简单格式（无表头）。

## 配置管理

### 保存配置
- 记录完位置后自动提示保存
- 或左键点击"配置操作" → "另存为配置..."

### 加载配置
- 右键点击"配置操作"
- 选择已保存的配置名称
- 或选择"加载配置..."浏览文件

### 配置文件位置
- `configs/` - 命名配置文件
- `window_config.json` - 默认配置
- `window_position.json` - 窗口位置
- `last_config.json` - 上次使用的配置

## 快捷操作

- **ESC键** - 取消位置记录
- **右键文本下拉框** - 删除/重命名文本
- **左键配置按钮** - 保存/清除配置
- **右键配置按钮** - 加载配置
- **Caps Lock指示器** - 绿色=关闭，红色=开启

## 系统要求

- Windows 10/11
- .NET 8.0 Runtime
- Microsoft Excel（可选，仅Excel功能需要）

## 项目结构

```
WindowInspector/
├── Models/              # 数据模型
├── Services/            # 业务逻辑
│   ├── WindowSelector   # 窗口选择
│   ├── InputRecorder    # 位置记录
│   ├── TextFiller       # 文本填充
│   └── ExcelService     # Excel操作
├── Utils/               # 工具类
│   ├── ConfigManager    # 配置管理
│   └── WindowHelper     # Windows API
├── Dialogs/             # 对话框
└── MainForm             # 主界面
```

## 技术栈

- .NET 8.0 WinForms
- Windows API (P/Invoke)
- COM Interop (Excel)
- Newtonsoft.Json

## 常见问题

**Q: 填充后没有反应？**  
A: 确保目标窗口仍然打开且位置未改变

**Q: Excel功能提示错误？**  
A: 需要安装Microsoft Office

**Q: 如何清除配置？**  
A: 左键点击"配置操作" → "清除当前配置"

**Q: 支持哪些窗口？**  
A: 支持所有标准Windows窗口（记事本、浏览器、Office等）

## 许可证

MIT License
